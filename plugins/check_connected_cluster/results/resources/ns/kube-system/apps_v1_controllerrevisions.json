[{"apiVersion":"apps/v1","data":{"spec":{"template":{"$patch":"replace","metadata":{"creationTimestamp":null,"labels":{"component":"kube-proxy","tier":"node"}},"spec":{"affinity":{"nodeAffinity":{"requiredDuringSchedulingIgnoredDuringExecution":{"nodeSelectorTerms":[{"matchExpressions":[{"key":"kubernetes.azure.com/cluster","operator":"Exists"}]}]}}},"containers":[{"command":["/hyperkube","kube-proxy","--kubeconfig=/var/lib/kubelet/kubeconfig","--cluster-cidr=10.244.0.0/16","--v=3"],"image":"mcr.microsoft.com/oss/kubernetes/hyperkube:v1.18.2","imagePullPolicy":"IfNotPresent","name":"kube-proxy","resources":{"requests":{"cpu":"100m"}},"securityContext":{"privileged":true},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/var/lib/kubelet","name":"kubeconfig","readOnly":true},{"mountPath":"/etc/kubernetes/certs","name":"certificates","readOnly":true},{"mountPath":"/run/xtables.lock","name":"iptableslock"}]}],"dnsPolicy":"ClusterFirst","hostNetwork":true,"nodeSelector":{"beta.kubernetes.io/os":"linux"},"priorityClassName":"system-node-critical","restartPolicy":"Always","schedulerName":"default-scheduler","securityContext":{},"serviceAccount":"kube-proxy","serviceAccountName":"kube-proxy","terminationGracePeriodSeconds":30,"tolerations":[{"key":"CriticalAddonsOnly","operator":"Exists"},{"effect":"NoExecute","operator":"Exists"},{"effect":"NoSchedule","operator":"Exists"}],"volumes":[{"hostPath":{"path":"/var/lib/kubelet","type":""},"name":"kubeconfig"},{"hostPath":{"path":"/etc/kubernetes/certs","type":""},"name":"certificates"},{"hostPath":{"path":"/run/xtables.lock","type":"FileOrCreate"},"name":"iptableslock"}]}}}},"kind":"ControllerRevision","metadata":{"annotations":{"deprecated.daemonset.template.generation":"1","kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"apps/v1\",\"kind\":\"DaemonSet\",\"metadata\":{\"annotations\":{},\"labels\":{\"addonmanager.kubernetes.io/mode\":\"Reconcile\",\"component\":\"kube-proxy\",\"tier\":\"node\"},\"name\":\"kube-proxy\",\"namespace\":\"kube-system\"},\"spec\":{\"selector\":{\"matchLabels\":{\"component\":\"kube-proxy\",\"tier\":\"node\"}},\"template\":{\"metadata\":{\"annotations\":null,\"labels\":{\"component\":\"kube-proxy\",\"tier\":\"node\"}},\"spec\":{\"affinity\":{\"nodeAffinity\":{\"requiredDuringSchedulingIgnoredDuringExecution\":{\"nodeSelectorTerms\":[{\"labelSelector\":null,\"matchExpressions\":[{\"key\":\"kubernetes.azure.com/cluster\",\"operator\":\"Exists\"}]}]}}},\"containers\":[{\"command\":[\"/hyperkube\",\"kube-proxy\",\"--kubeconfig=/var/lib/kubelet/kubeconfig\",\"--cluster-cidr=10.244.0.0/16\",\"--v=3\"],\"image\":\"mcr.microsoft.com/oss/kubernetes/hyperkube:v1.18.2\",\"name\":\"kube-proxy\",\"resources\":{\"requests\":{\"cpu\":\"100m\"}},\"securityContext\":{\"privileged\":true},\"volumeMounts\":[{\"mountPath\":\"/var/lib/kubelet\",\"name\":\"kubeconfig\",\"readOnly\":true},{\"mountPath\":\"/etc/kubernetes/certs\",\"name\":\"certificates\",\"readOnly\":true},{\"mountPath\":\"/run/xtables.lock\",\"name\":\"iptableslock\"}]}],\"hostNetwork\":true,\"nodeSelector\":{\"beta.kubernetes.io/os\":\"linux\"},\"priorityClassName\":\"system-node-critical\",\"serviceAccountName\":\"kube-proxy\",\"tolerations\":[{\"key\":\"CriticalAddonsOnly\",\"operator\":\"Exists\"},{\"effect\":\"NoExecute\",\"operator\":\"Exists\"},{\"effect\":\"NoSchedule\",\"operator\":\"Exists\"}],\"volumes\":[{\"hostPath\":{\"path\":\"/var/lib/kubelet\"},\"name\":\"kubeconfig\"},{\"hostPath\":{\"path\":\"/etc/kubernetes/certs\"},\"name\":\"certificates\"},{\"hostPath\":{\"path\":\"/run/xtables.lock\",\"type\":\"FileOrCreate\"},\"name\":\"iptableslock\"}]}},\"updateStrategy\":{\"rollingUpdate\":{\"maxUnavailable\":1},\"type\":\"RollingUpdate\"}}}\n"},"creationTimestamp":"2020-06-08T12:05:51Z","labels":{"component":"kube-proxy","controller-revision-hash":"574b7f84cd","tier":"node"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:data":{},"f:metadata":{"f:annotations":{".":{},"f:deprecated.daemonset.template.generation":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}},"f:labels":{".":{},"f:component":{},"f:controller-revision-hash":{},"f:tier":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"dc139163-d748-4d77-a7db-760a7ce7fb03\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:revision":{}},"manager":"kube-controller-manager","operation":"Update","time":"2020-06-08T12:05:51Z"}],"name":"kube-proxy-574b7f84cd","namespace":"kube-system","ownerReferences":[{"apiVersion":"apps/v1","blockOwnerDeletion":true,"controller":true,"kind":"DaemonSet","name":"kube-proxy","uid":"dc139163-d748-4d77-a7db-760a7ce7fb03"}],"resourceVersion":"454","selfLink":"/apis/apps/v1/namespaces/kube-system/controllerrevisions/kube-proxy-574b7f84cd","uid":"a842c719-bf12-49ed-a366-9fd436560af4"},"revision":1},{"apiVersion":"apps/v1","data":{"spec":{"template":{"$patch":"replace","metadata":{"annotations":{"WSID":"MDhhMmZkNjEtODk1OS00NDUyLTgxMmUtZTNlNTY0ZjA4OWQz","agentVersion":"1.10.0.1","dockerProviderVersion":"8.0.0-3","schema-versions":"v1"},"creationTimestamp":null,"labels":{"component":"oms-agent","tier":"node"}},"spec":{"affinity":{"nodeAffinity":{"requiredDuringSchedulingIgnoredDuringExecution":{"nodeSelectorTerms":[{"matchExpressions":[{"key":"kubernetes.azure.com/cluster","operator":"Exists"},{"key":"type","operator":"NotIn","values":["virtual-kubelet"]}]}]}}},"containers":[{"env":[{"name":"NODE_IP","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"status.hostIP"}}},{"name":"AKS_CLUSTER_NAME","value":"akkesharaks"},{"name":"AKS_RESOURCE_ID","value":"/subscriptions/1bfbb5d0-917e-4346-9026-1d3b344417f5/resourceGroups/akkeshar-test2/providers/Microsoft.ContainerService/managedClusters/akkesharaks"},{"name":"AKS_NODE_RESOURCE_GROUP","value":"MC_akkeshar-test2_akkesharaks_eastus2"},{"name":"AKS_REGION","value":"eastus2"},{"name":"CONTROLLER_TYPE","value":"DaemonSet"},{"name":"USER_ASSIGNED_IDENTITY_CLIENT_ID"}],"image":"mcr.microsoft.com/azuremonitor/containerinsights/ciprod:ciprod03022020","imagePullPolicy":"IfNotPresent","livenessProbe":{"exec":{"command":["/bin/bash","-c","/opt/livenessprobe.sh"]},"failureThreshold":3,"initialDelaySeconds":60,"periodSeconds":60,"successThreshold":1,"timeoutSeconds":1},"name":"omsagent","ports":[{"containerPort":25225,"protocol":"TCP"},{"containerPort":25224,"protocol":"UDP"}],"resources":{"limits":{"cpu":"150m","memory":"600Mi"},"requests":{"cpu":"75m","memory":"225Mi"}},"securityContext":{"privileged":true},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","volumeMounts":[{"mountPath":"/hostfs","name":"host-root","readOnly":true},{"mountPath":"/var/run/host","name":"docker-sock"},{"mountPath":"/var/log","name":"host-log"},{"mountPath":"/var/lib/docker/containers","name":"containerlog-path"},{"mountPath":"/etc/kubernetes/host","name":"azure-json-path"},{"mountPath":"/etc/omsagent-secret","name":"omsagent-secret"},{"mountPath":"/etc/config/settings","name":"settings-vol-config","readOnly":true}]}],"dnsPolicy":"ClusterFirst","nodeSelector":{"beta.kubernetes.io/os":"linux"},"priorityClassName":"system-node-critical","restartPolicy":"Always","schedulerName":"default-scheduler","securityContext":{},"serviceAccount":"omsagent","serviceAccountName":"omsagent","terminationGracePeriodSeconds":30,"tolerations":[{"key":"CriticalAddonsOnly","operator":"Exists"},{"effect":"NoExecute","operator":"Exists"},{"effect":"NoSchedule","operator":"Exists"},{"effect":"PreferNoSchedule","operator":"Exists"}],"volumes":[{"hostPath":{"path":"/","type":""},"name":"host-root"},{"hostPath":{"path":"/var/run","type":""},"name":"docker-sock"},{"hostPath":{"path":"/etc/hostname","type":""},"name":"container-hostname"},{"hostPath":{"path":"/var/log","type":""},"name":"host-log"},{"hostPath":{"path":"/var/lib/docker/containers","type":""},"name":"containerlog-path"},{"hostPath":{"path":"/etc/kubernetes","type":""},"name":"azure-json-path"},{"name":"omsagent-secret","secret":{"defaultMode":420,"secretName":"omsagent-secret"}},{"configMap":{"defaultMode":420,"name":"container-azm-ms-agentconfig","optional":true},"name":"settings-vol-config"}]}}}},"kind":"ControllerRevision","metadata":{"annotations":{"deprecated.daemonset.template.generation":"1","kubectl.kubernetes.io/last-applied-configuration":"{\"apiVersion\":\"apps/v1\",\"kind\":\"DaemonSet\",\"metadata\":{\"annotations\":{},\"labels\":{\"addonmanager.kubernetes.io/mode\":\"Reconcile\",\"component\":\"oms-agent\",\"kubernetes.io/cluster-service\":\"true\",\"tier\":\"node\"},\"name\":\"omsagent\",\"namespace\":\"kube-system\"},\"spec\":{\"selector\":{\"matchLabels\":{\"component\":\"oms-agent\",\"tier\":\"node\"}},\"template\":{\"metadata\":{\"annotations\":{\"WSID\":\"MDhhMmZkNjEtODk1OS00NDUyLTgxMmUtZTNlNTY0ZjA4OWQz\",\"agentVersion\":\"1.10.0.1\",\"dockerProviderVersion\":\"8.0.0-3\",\"schema-versions\":\"v1\"},\"labels\":{\"component\":\"oms-agent\",\"tier\":\"node\"}},\"spec\":{\"affinity\":{\"nodeAffinity\":{\"requiredDuringSchedulingIgnoredDuringExecution\":{\"nodeSelectorTerms\":[{\"matchExpressions\":[{\"key\":\"kubernetes.azure.com/cluster\",\"operator\":\"Exists\"},{\"key\":\"type\",\"operator\":\"NotIn\",\"values\":[\"virtual-kubelet\"]}]}]}}},\"containers\":[{\"env\":[{\"name\":\"NODE_IP\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"status.hostIP\"}}},{\"name\":\"AKS_CLUSTER_NAME\",\"value\":\"akkesharaks\"},{\"name\":\"AKS_RESOURCE_ID\",\"value\":\"/subscriptions/1bfbb5d0-917e-4346-9026-1d3b344417f5/resourceGroups/akkeshar-test2/providers/Microsoft.ContainerService/managedClusters/akkesharaks\"},{\"name\":\"AKS_NODE_RESOURCE_GROUP\",\"value\":\"MC_akkeshar-test2_akkesharaks_eastus2\"},{\"name\":\"AKS_REGION\",\"value\":\"eastus2\"},{\"name\":\"CONTROLLER_TYPE\",\"value\":\"DaemonSet\"},{\"name\":\"USER_ASSIGNED_IDENTITY_CLIENT_ID\",\"value\":\"\"}],\"image\":\"mcr.microsoft.com/azuremonitor/containerinsights/ciprod:ciprod03022020\",\"imagePullPolicy\":\"IfNotPresent\",\"livenessProbe\":{\"exec\":{\"command\":[\"/bin/bash\",\"-c\",\"/opt/livenessprobe.sh\"]},\"initialDelaySeconds\":60,\"periodSeconds\":60},\"name\":\"omsagent\",\"ports\":[{\"containerPort\":25225,\"protocol\":\"TCP\"},{\"containerPort\":25224,\"protocol\":\"UDP\"}],\"resources\":{\"limits\":{\"cpu\":\"150m\",\"memory\":\"600Mi\"},\"requests\":{\"cpu\":\"75m\",\"memory\":\"225Mi\"}},\"securityContext\":{\"privileged\":true},\"volumeMounts\":[{\"mountPath\":\"/hostfs\",\"name\":\"host-root\",\"readOnly\":true},{\"mountPath\":\"/var/run/host\",\"name\":\"docker-sock\"},{\"mountPath\":\"/var/log\",\"name\":\"host-log\"},{\"mountPath\":\"/var/lib/docker/containers\",\"name\":\"containerlog-path\"},{\"mountPath\":\"/etc/kubernetes/host\",\"name\":\"azure-json-path\"},{\"mountPath\":\"/etc/omsagent-secret\",\"name\":\"omsagent-secret\"},{\"mountPath\":\"/etc/config/settings\",\"name\":\"settings-vol-config\",\"readOnly\":true}]}],\"nodeSelector\":{\"beta.kubernetes.io/os\":\"linux\"},\"priorityClassName\":\"system-node-critical\",\"serviceAccountName\":\"omsagent\",\"tolerations\":[{\"key\":\"CriticalAddonsOnly\",\"operator\":\"Exists\"},{\"effect\":\"NoExecute\",\"operator\":\"Exists\"},{\"effect\":\"NoSchedule\",\"operator\":\"Exists\"},{\"effect\":\"PreferNoSchedule\",\"operator\":\"Exists\"}],\"volumes\":[{\"hostPath\":{\"path\":\"/\"},\"name\":\"host-root\"},{\"hostPath\":{\"path\":\"/var/run\"},\"name\":\"docker-sock\"},{\"hostPath\":{\"path\":\"/etc/hostname\"},\"name\":\"container-hostname\"},{\"hostPath\":{\"path\":\"/var/log\"},\"name\":\"host-log\"},{\"hostPath\":{\"path\":\"/var/lib/docker/containers\"},\"name\":\"containerlog-path\"},{\"hostPath\":{\"path\":\"/etc/kubernetes\"},\"name\":\"azure-json-path\"},{\"name\":\"omsagent-secret\",\"secret\":{\"secretName\":\"omsagent-secret\"}},{\"configMap\":{\"name\":\"container-azm-ms-agentconfig\",\"optional\":true},\"name\":\"settings-vol-config\"}]}},\"updateStrategy\":{\"rollingUpdate\":{\"maxUnavailable\":\"50%\"},\"type\":\"RollingUpdate\"}}}\n"},"creationTimestamp":"2020-06-08T12:05:49Z","labels":{"component":"oms-agent","controller-revision-hash":"7486888dc8","tier":"node"},"managedFields":[{"apiVersion":"apps/v1","fieldsType":"FieldsV1","fieldsV1":{"f:data":{},"f:metadata":{"f:annotations":{".":{},"f:deprecated.daemonset.template.generation":{},"f:kubectl.kubernetes.io/last-applied-configuration":{}},"f:labels":{".":{},"f:component":{},"f:controller-revision-hash":{},"f:tier":{}},"f:ownerReferences":{".":{},"k:{\"uid\":\"514ecd1b-3054-4396-b121-4c94fe009b79\"}":{".":{},"f:apiVersion":{},"f:blockOwnerDeletion":{},"f:controller":{},"f:kind":{},"f:name":{},"f:uid":{}}}},"f:revision":{}},"manager":"kube-controller-manager","operation":"Update","time":"2020-06-08T12:05:49Z"}],"name":"omsagent-7486888dc8","namespace":"kube-system","ownerReferences":[{"apiVersion":"apps/v1","blockOwnerDeletion":true,"controller":true,"kind":"DaemonSet","name":"omsagent","uid":"514ecd1b-3054-4396-b121-4c94fe009b79"}],"resourceVersion":"402","selfLink":"/apis/apps/v1/namespaces/kube-system/controllerrevisions/omsagent-7486888dc8","uid":"dfbeb692-9cc2-4fb1-a5d5-30b6e0118ab6"},"revision":1}]